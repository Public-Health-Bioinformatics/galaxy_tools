<tool id="micall-lite" name="micall-lite" version="@TOOL_VERSION@+galaxy0">
    <description></description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">micall-lite</requirement>
    </requirements>
    <version_command>echo "@TOOL_VERSION@"</version_command>
    <command detect_errors="exit_code">
        <![CDATA[
          #def get_type($data)
            #if $data.is_of_type('fastq'):
                #return 'fastq'
            #elif $data.is_of_type('fastqsanger'):
                #return 'fastqsanger'
            #elif $data.is_of_type('fasta.gz'):
                #return 'fasta.gz'
            #elif $data.is_of_type('fastq.gz'):
                #return 'fastq.gz'
            #elif $data.is_of_type('fastq.bz2'):
                #return 'fastq.bz2'
            #end if
          #end def

          #if $single_paired.single_paired_selector == "yes"
                --paired 
                '${single_paired.forward_input}' '${single_paired.reverse_input}'
            #elif $single_paired.single_paired_selector == "collection":
                --paired 
                '${single_paired.input_pair.forward}' '${single_paired.input_pair.reverse}'
          ln -s '${input_pair.forward}' '${input_pair.element_identifier}_R1.fastq.gz' &&
          ln -s '${input_pair.reverse}' '${input_pair.element_identifier}_R2.fastq.gz' &&
          mkdir 'outdir' &&
          micall
          --threads \${GALAXY_SLOTS:-1}
            '${input_pair.element_identifier}_R1.fastq.gz'
            '${input_pair.element_identifier}_R2.fastq.gz'
          --readlen ${readlen}
          --outdir 'outdir'
        ]]>
    </command>
    <inputs>
        <conditional name="single_paired">
            <param name="single_paired_selector" type="select" label="Single or paired reads" help="--paired">
                <option value="collection">Paired Collection</option>
                <option selected="true" value="paired">Paired</option>
            </param>
            <when value="collection">
                <param format="@INTYPES@" name="input_pair" type="data_collection" collection_type="paired" label="Collection of paired reads"/>
            </when>
            <when value="paired">
                <param format="@INTYPES@" name="forward_input" type="data" label="Forward strand"/>
                <param format="@INTYPES@" name="reverse_input" type="data" label="Reverse strand"/>
            </when>
        </conditional>
        <param format="fastqsanger,fastqsanger.gz" name="input_pair" type="data_collection" collection_type="paired" label="Collection of paired reads" help="FASTQ datasets" />
        <param name="readlen" type="integer" min="1" value="251" max="600" label="Read Length" help="Read Length" />
    </inputs>
    <outputs>
        <data name="align" label="align" format="csv" from_work_dir="outdir/*.align.csv" />
        <data name="amino" label="amino" format="csv" from_work_dir="outdir/*.amino.csv" />
        <data name="conseq" label="conseq" format="csv" from_work_dir="outdir/*.conseq.csv" />
        <data name="insert" label="insert" format="csv" from_work_dir="outdir/*.insert.csv" />
        <data name="nuc" label="nuc" format="csv" from_work_dir="outdir/*.nuc.csv" />
    </outputs>
    <tests>
        <test>
            <param name=>
        </test>
    </tests>
    <help><![CDATA[
    ]]></help>
    <expand macro="citations" />
</tool>
